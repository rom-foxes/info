<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Job Exp Calc</title>
</head>
<body>
<script>
    // level	BaseExp	JobExp FirstJob	SecondJob	2ndTrascended	ThirdJob

    // let start = {lvl: 43, t: 3, exp: 18975633}
    // let stop = {lvl: 47, t: 3, exp: 32609115}

    const getExp = (start, stop) => {
        const exp = [
            {t: 1, l: 2, e: 830},
            {t: 1, l: 3, e: 1490},
            {t: 1, l: 4, e: 2970},
            {t: 1, l: 5, e: 4290},
            {t: 1, l: 6, e: 5610},
            {t: 1, l: 7, e: 6930},
            {t: 1, l: 8, e: 8250},
            {t: 1, l: 9, e: 9570},
            {t: 1, l: 10, e: 10890},
            {t: 1, l: 11, e: 13210},
            {t: 1, l: 12, e: 19810},
            {t: 1, l: 13, e: 26410},
            {t: 1, l: 14, e: 33010},
            {t: 1, l: 15, e: 39620},
            {t: 1, l: 16, e: 46220},
            {t: 1, l: 17, e: 52820},
            {t: 1, l: 18, e: 59420},
            {t: 1, l: 19, e: 66030},
            {t: 1, l: 20, e: 72630},
            {t: 1, l: 21, e: 79230},
            {t: 1, l: 22, e: 88210},
            {t: 1, l: 23, e: 89270},
            {t: 1, l: 24, e: 90410},
            {t: 1, l: 25, e: 91650},
            {t: 1, l: 26, e: 92970},
            {t: 1, l: 27, e: 94380},
            {t: 1, l: 28, e: 95880},
            {t: 1, l: 29, e: 97470},
            {t: 1, l: 30, e: 99150},
            {t: 1, l: 31, e: 100910},
            {t: 1, l: 32, e: 102760},
            {t: 1, l: 33, e: 104700},
            {t: 1, l: 34, e: 106730},
            {t: 1, l: 35, e: 108850},
            {t: 1, l: 36, e: 111060},
            {t: 1, l: 37, e: 113350},
            {t: 1, l: 38, e: 115730},
            {t: 1, l: 39, e: 122040},
            {t: 1, l: 40, e: 139480},
            {t: 2, l: 2, e: 7560},
            {t: 2, l: 3, e: 9300},
            {t: 2, l: 4, e: 11040},
            {t: 2, l: 5, e: 12790},
            {t: 2, l: 6, e: 12530},
            {t: 2, l: 7, e: 23250},
            {t: 2, l: 8, e: 31960},
            {t: 2, l: 9, e: 40680},
            {t: 2, l: 10, e: 72650},
            {t: 2, l: 11, e: 107502},
            {t: 2, l: 12, e: 145290},
            {t: 2, l: 13, e: 185970},
            {t: 2, l: 14, e: 299560},
            {t: 2, l: 15, e: 276050},
            {t: 2, l: 16, e: 325450},
            {t: 2, l: 17, e: 377760},
            {t: 2, l: 18, e: 432970},
            {t: 2, l: 19, e: 491080},
            {t: 2, l: 20, e: 552110},
            {t: 2, l: 21, e: 616040},
            {t: 2, l: 22, e: 682870},
            {t: 2, l: 23, e: 752610},
            {t: 2, l: 24, e: 825260},
            {t: 2, l: 25, e: 900810},
            {t: 2, l: 26, e: 979260},
            {t: 2, l: 27, e: 1060630},
            {t: 2, l: 28, e: 1144900},
            {t: 2, l: 29, e: 1232070},
            {t: 2, l: 30, e: 1322150},
            {t: 2, l: 31, e: 1415140},
            {t: 2, l: 32, e: 1511030},
            {t: 2, l: 33, e: 1609830},
            {t: 2, l: 34, e: 1711530},
            {t: 2, l: 35, e: 1816140},
            {t: 2, l: 36, e: 1923660},
            {t: 2, l: 37, e: 2034080},
            {t: 2, l: 38, e: 2147410},
            {t: 2, l: 39, e: 2263640},
            {t: 2, l: 40, e: 2382780},
            {t: 3, l: 2, e: 68460},
            {t: 3, l: 3, e: 84260},
            {t: 3, l: 4, e: 100060},
            {t: 3, l: 5, e: 115860},
            {t: 3, l: 6, e: 131660},
            {t: 3, l: 7, e: 210660},
            {t: 3, l: 8, e: 289650},
            {t: 3, l: 9, e: 368650},
            {t: 3, l: 10, e: 526640},
            {t: 3, l: 11, e: 800280},
            {t: 3, l: 12, e: 1088720},
            {t: 3, l: 13, e: 1391120},
            {t: 3, l: 14, e: 1706690},
            {t: 3, l: 15, e: 2034740},
            {t: 3, l: 16, e: 2374570},
            {t: 3, l: 17, e: 2725590},
            {t: 3, l: 18, e: 3087190},
            {t: 3, l: 19, e: 3458860},
            {t: 3, l: 20, e: 3840080},
            {t: 3, l: 21, e: 4230380},
            {t: 3, l: 22, e: 4629320},
            {t: 3, l: 23, e: 5036500},
            {t: 3, l: 24, e: 5451530},
            {t: 3, l: 25, e: 5874050},
            {t: 3, l: 26, e: 6303700},
            {t: 3, l: 27, e: 6740190},
            {t: 3, l: 28, e: 7183190},
            {t: 3, l: 29, e: 7632440},
            {t: 3, l: 30, e: 8087660},
            {t: 3, l: 31, e: 8548610},
            {t: 3, l: 32, e: 9015030},
            {t: 3, l: 33, e: 9486710},
            {t: 3, l: 34, e: 9963430},
            {t: 3, l: 35, e: 10444990},
            {t: 3, l: 36, e: 10931210},
            {t: 3, l: 37, e: 11421900},
            {t: 3, l: 38, e: 11916880},
            {t: 3, l: 39, e: 12416000},
            {t: 3, l: 40, e: 12919100},
            {t: 3, l: 41, e: 2548640},
            {t: 3, l: 42, e: 2803500},
            {t: 3, l: 43, e: 3185800},
            {t: 3, l: 44, e: 3695530},
            {t: 3, l: 45, e: 4332690},
            {t: 3, l: 46, e: 5097280},
            {t: 3, l: 47, e: 5989310},
            {t: 3, l: 48, e: 7008770},
            {t: 3, l: 49, e: 8155660},
            {t: 3, l: 50, e: 9429980},
            {t: 3, l: 51, e: 10831730},
            {t: 3, l: 52, e: 12360920},
            {t: 3, l: 53, e: 14017540},
            {t: 3, l: 54, e: 15801590},
            {t: 3, l: 55, e: 17713070},
            {t: 3, l: 56, e: 19751980},
            {t: 3, l: 57, e: 21918330},
            {t: 3, l: 58, e: 24212110},
            {t: 3, l: 59, e: 26633320},
            {t: 3, l: 60, e: 29181970},
            {t: 3, l: 61, e: 31858040},
            {t: 3, l: 62, e: 34661550},
            {t: 3, l: 63, e: 37592490},
            {t: 3, l: 64, e: 40650860},
            {t: 3, l: 65, e: 43836670},
            {t: 3, l: 66, e: 47149900},
            {t: 3, l: 67, e: 50590570},
            {t: 3, l: 68, e: 54158670},
            {t: 3, l: 69, e: 57854210},
            {t: 3, l: 70, e: 61677170},
            {t: 4, l: 2, e: 3867200},
            {t: 4, l: 3, e: 4261080},
            {t: 4, l: 4, e: 4762390},
            {t: 4, l: 5, e: 5371110},
            {t: 4, l: 6, e: 6087260},
            {t: 4, l: 7, e: 6910830},
            {t: 4, l: 8, e: 7841830},
            {t: 4, l: 9, e: 8880240},
            {t: 4, l: 10, e: 10026080},
            {t: 4, l: 11, e: 11279340},
            {t: 4, l: 12, e: 12640020},
            {t: 4, l: 13, e: 14108120},
            {t: 4, l: 14, e: 15683650},
            {t: 4, l: 15, e: 17366600},
            {t: 4, l: 16, e: 19156970},
            {t: 4, l: 17, e: 21054760},
            {t: 4, l: 18, e: 23059980},
            {t: 4, l: 19, e: 25172620},
            {t: 4, l: 20, e: 27392680},
            {t: 4, l: 21, e: 29720160},
            {t: 4, l: 22, e: 32155070},
            {t: 4, l: 23, e: 34697390},
            {t: 4, l: 24, e: 37347140},
            {t: 4, l: 25, e: 40104310},
            {t: 4, l: 26, e: 42968910},
            {t: 4, l: 27, e: 45940920},
            {t: 4, l: 28, e: 49020360},
            {t: 4, l: 29, e: 52207220},
            {t: 4, l: 30, e: 55501500},
            {t: 4, l: 31, e: 58903210},
            {t: 4, l: 32, e: 62412340},
            {t: 4, l: 33, e: 66028890},
            {t: 4, l: 34, e: 69752860},
            {t: 4, l: 35, e: 73584250},
            {t: 4, l: 36, e: 77523070},
            {t: 4, l: 37, e: 81569310},
            {t: 4, l: 38, e: 85722970},
            {t: 4, l: 39, e: 89984050},
            {t: 4, l: 40, e: 94352560},
            {t: 4, l: 41, e: 12010270},
            {t: 4, l: 42, e: 14532420},
            {t: 4, l: 43, e: 17655090},
            {t: 4, l: 44, e: 21378270},
            {t: 4, l: 45, e: 25701970},
            {t: 4, l: 46, e: 30616180},
            {t: 4, l: 47, e: 36150900},
            {t: 4, l: 48, e: 42276120},
            {t: 4, l: 49, e: 49001880},
            {t: 4, l: 50, e: 56328140},
            {t: 4, l: 51, e: 64254920},
            {t: 4, l: 52, e: 72782210},
            {t: 4, l: 53, e: 81910010},
            {t: 4, l: 54, e: 91638320},
            {t: 4, l: 55, e: 101967150},
            {t: 4, l: 56, e: 112896490},
            {t: 4, l: 57, e: 124426350},
            {t: 4, l: 58, e: 136556720},
            {t: 4, l: 59, e: 149287600},
            {t: 4, l: 60, e: 162618990},
            {t: 4, l: 61, e: 163532310},
            {t: 4, l: 62, e: 166148830},
            {t: 4, l: 63, e: 170073600},
            {t: 4, l: 64, e: 175306640},
            {t: 4, l: 65, e: 181847930},
            {t: 4, l: 66, e: 189697480},
            {t: 4, l: 67, e: 198855290},
            {t: 4, l: 68, e: 209321360},
            {t: 4, l: 69, e: 221095690},
            {t: 4, l: 70, e: 234178270},
            {t: 4, l: 71, e: 240110290},
            {t: 4, l: 72, e: 241550950},
            {t: 4, l: 73, e: 243952050},
            {t: 4, l: 74, e: 247313600},
            {t: 4, l: 75, e: 251635580},
            {t: 4, l: 76, e: 256918010},
            {t: 4, l: 77, e: 263160880},
            {t: 4, l: 78, e: 270364180},
            {t: 4, l: 79, e: 278527930},
            {t: 4, l: 80, e: 287652130},
        ]

        let currentIndex = exp.map((e, i) => e.t == (start.t + 1) && e.l == (start.lvl + 1) ? i : 0).reduce((a, b) => a + b)
        const stopIndex = exp.map((e, i) => e.t == (stop.t + 1) && e.l == (stop.lvl) ? i : 0).reduce((a, b) => a + b)

        console.log('start at: ' + currentIndex)
        console.log('stop at: ' + stopIndex)

        let totJ = exp[currentIndex].e - start.exp
        console.log(totJ)

        do {
            currentIndex++

            console.log('adding ' + exp[currentIndex].e)

            totJ += exp[currentIndex].e
        }
        while (currentIndex < stopIndex)

        totJ += stop.exp

        console.log(totJ)

        return totJ
    }

    // let res = getExp(start, stop)

    // console.log(res)
    //
    const calc = () => {
        const s = {
            lvl: parseInt(document.getElementById('s_l').value),
            t: parseInt(document.getElementById('s_t').value) - 1,
            exp: parseInt(document.getElementById('s_e').value)
        }
        const e = {
            lvl: parseInt(document.getElementById('e_l').value),
            t: parseInt(document.getElementById('e_t').value) - 1,
            exp: parseInt(document.getElementById('e_e').value)
        }

        console.log(s,e)

        document.getElementById('res').value = new Intl.NumberFormat().format(getExp(s, e))

    }

</script>

<form action="#">
    <div><h3>начало кача:</h3>
        <table>
            <tr>
                <td><label for="s_t">профа</label></td>
                <td><select id="s_t">
                    <option value="1">1 профа (1-40)</option>
                    <option value="2">2 профа, T1 (1-40)</option>
                    <option value="3">3 профа, T2 (1-70)</option>
                    <option value="4" selected="selected">4 профа, T3 (1-80)</option>
                </select></td>
            </tr>
            <tr>
                <td><label for="s_l">лвл</label></td>
                <td><input type="number" id="s_l" value="43" placeholder="43"/><br/></td>
            </tr>
            <tr>
                <td><label for="s_l">джоб эксп</label></td>
                <td><input type="number" id="s_e" placeholder="18975633" value="18975633"/></td>
            </tr>
        </table>
    </div>
    <div><h3>конец кача:</h3>
        <table>
            <tr>
                <td><label for="e_t">профа</label></td>
                <td><select id="e_t">
                    <option value="1">1 профа (1-40)</option>
                    <option value="2">2 профа, T1 (1-40)</option>
                    <option value="3">3 профа, T2 (1-70)</option>
                    <option value="4" selected="selected">4 профа, T3 (1-80)</option>
                </select></td>
            </tr>
            <tr>
                <td><label for="e_l">лвл</label></td>
                <td><input type="number" id="e_l" placeholder="47" value="47"/><br/></td>
            </tr>
            <tr>
                <td><label for="e_l">джоб эксп</label></td>
                <td><input type="number" id="e_e" placeholder="32609115" value="32609115"/></td>
            </tr>
        </table>
    </div>
    <input type="button" value="Фырк!" onclick="calc()"/>
</form>

<h3>итого было всосано джоб экспа</h3><input id="res" type="text" />

</body>
</html>